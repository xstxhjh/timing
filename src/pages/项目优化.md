[title]: # (搭建前端架构总结及注意事项)
[date]: # (2020-05-30 &nbsp; 15:10:32)
[categories]: # (架构)
[description]: # (合理的利用资源，整合你将来可能所用到的每一个点。)
[image]: # (https://i.loli.net/2020/06/01/FdK3PVzJipf5WCs.jpg)

---

setImmediate 跨浏览器实现的 setImmediate 和 clearImmediate API

process.nextTick 是将异步回调放到当前帧的末尾、io回调之前，如果nextTick过多，会导致io回调不断延后,最后callback堆积太多

setImmediate 是将异步回调放到下一帧,不影响io回调,不会造成callback 堆积

速度比 setTimeout(…, 0) 快


timers-browserify

补充与 Node.js 模块相同的其它功能
- enroll(item, delay)
- unenroll(item)
- active(item)


# 主体架构

axios 对应 request.js
router 对应 router.js
vuex 对应 store.js

template 使用的是 pug

尽可能减少项目样式布局的 dom 层数


# 安全

## XSS攻击

攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。

JSX、templates 渲染之前, virtual DOM 会转义渲染的数据。 从而保证用户无法注入任何应用之外的代码。在被渲染之前，所有的数据都被转义成为了字符串处理。 以避免 XSS(跨站脚本) 攻击。

Injecting Raw Html is possible in the current frameworks. [→Demo](https://github.com/sqreen/VueXSSDemo)

- React uses dangerouslySetInnerHTML
- Angular uses [innerHtml]
- Vue uses : v-html

## CSRF攻击

利用 cookie 自动携带的特性以及跨站请求攻击，攻击者并不能通过CSRF攻击来直接获取用户的账户控制权，也不能直接窃取用户的任何信息。他们能做到的，是欺骗用户的浏览器，让其以用户的名义运行操作。

### 检查 Referer 字段

这个字段用以标明请求来源于哪个地址。虽然http协议对此字段的内容有明确的规定，但并无法保证来访的浏览器的具体实现，亦无法保证浏览器没有安全漏洞影响到此字段。并且也存在攻击者攻击某些浏览器，篡改其Referer字段的可能。

### Token 验证

前端记录登录 token，每次请求的时候通过在 Header 中添加认证头的方式来实现登录校验过程。由于 CSRF 攻击中攻击者无法知道该 token 值，通过这种方式也是可以防止 CSRF 攻击的。