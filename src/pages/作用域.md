[title]: # (作用域)
[date]: # (2018-12-11 &nbsp; 15:15:29)
[categories]: # (词法作用域)
[description]: # (是序，这也是开始。有开始，当然就会有结束；而结束，是下一段旅程的开始。)
[image]: # (https://i.loli.net/2020/03/30/kbJmV4grw8iRx2t.jpg)

---

# 一、作用域是什么？

编程语言设计了一套良好的规则来储存变量，并且之后可以方便地找到这些变量，这套规则被称为作用域。

（简单来说，作用域就是能让你储存变量当中的值，并且之后能够进行访问和修改）

# 二、编译流程

- 分词/词法分析 （完成分词这个目的，需要通过词法分析这个手段）

    这个过程会将由字符组成的字符串分解成（对编程语言来说）有意义的代码块，这些代码块被称为词法单元。

- 解析/语法分析

    这个过程是将词法单元流（数组）转换成一个由元素逐级嵌套所组成的代表了程序语法结构的树（抽象语法树–AST）。

- 代码生成

    将 AST 转换为可执行代码的过程称被称为代码生成。这个过程与语言、目标平台等息息相关。

注：JavaScript 引擎编译流程更为复杂，比如，在语法分析和代码生成阶段有特定的步骤对性能进行优化，包括对冗余元素进行优化。并且对于 JavaScript 而言，大部分情况下编译发生在代码执行前的几微秒内。JavaScript 引擎用尽了各种办法（比如即时编译–JIT）来保证性能最佳。

# 三、各自的职责

- 引擎：负责整个编译和执行过程

- 编译器：负责语法分析及代码生成

- 作用域：负责收集并维护所有声明的变量，组成的一系列查询，并实施一套严格的规则，确定当前执行的代码对折现变量的访问权限。

# 四、变量的赋值操作

变量的赋值操作会执行两个动作，首先编译器会在当前作用域中声明一个变量（如果之前没有声明），然后在运行时引擎会在作用域中查找该变量，如果能够找到就会对它赋值。

LHS 和 RHS，当引擎执行编译器给的代码（赋值操作）时，会通过查找这个变量来判断这个变量是否已经声明，这个过程需要作用域的协助，而查找的方式分为两种：LHS（”赋值操作的目标是谁”）和 RHS（”谁是赋值操作的源头”）。

- LHS：赋值操作的左侧，试图查找到变量的容器本身，从而可以对其赋值，即找到复制操作的目标。
- RHS：另外一种查找，可以简单理解为复制操作的右侧，其查找目标为取到目标的源值，即找到这个变量具体的值而非容器。



```js
function foo(a) {
var b = a;
return a + b;
}
var c = foo( 2 );

/*
1. 找出所有的 LHS 查询（这里有 3 处！）
c = ..; 、 a = 2 （隐式变量分配）、 b = ..

2. 找出所有的 RHS 查询（这里有 4 处！）
foo(2.. 、 = a; 、 a .. 、 .. b
*/
```
